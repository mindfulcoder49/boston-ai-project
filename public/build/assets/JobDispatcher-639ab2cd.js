import{o as l,d as r,b as t,t as u,r as A,f as L,e as $,T as C,g as J,c as N,w as b,a as w,u as o,Z as Y,h as n,v as x,j as k,F as v,k as y,l as h}from"./app-59f66305.js";import{A as T}from"./AdminLayout-1b49a627.js";import{_ as B}from"./_plugin-vue_export-helper-c27b6911.js";import"./NavLink-5e46c6e3.js";const O={class:"bg-white shadow-md rounded-lg p-6"},Z={class:"flex flex-col sm:flex-row justify-between sm:items-start"},E={class:"text-xl font-semibold text-gray-800"},G={class:"text-sm text-gray-500 mt-1"},H={class:"text-xs text-gray-400 mt-1 font-mono"},K={key:0,class:"mt-6 pt-4 border-t border-gray-200"},V={__name:"JobCard",props:{command:String,title:String,description:String},emits:["dispatch"],setup(c){return(g,a)=>(l(),r("div",O,[t("div",Z,[t("div",null,[t("h2",E,u(c.title),1),t("p",G,u(c.description),1),t("p",H,"Command: "+u(c.command),1)]),t("button",{onClick:a[0]||(a[0]=m=>g.$emit("dispatch")),class:"mt-4 sm:mt-0 sm:ml-4 px-6 py-2 bg-indigo-600 text-white font-semibold rounded-md shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap"},[A(g.$slots,"button-text",{},()=>[a[1]||(a[1]=L("Dispatch Job"))])])]),g.$slots.default?(l(),r("div",K,[a[2]||(a[2]=t("h3",{class:"text-md font-medium text-gray-700 mb-3"},"Parameters",-1)),A(g.$slots,"default")])):$("",!0)]))}};const P={class:"container mx-auto"},q={key:0,class:"mb-4 p-4 bg-green-100 text-green-700 rounded-md"},z={key:1,class:"mb-4 p-4 bg-red-100 text-red-700 rounded-md"},Q={key:2,class:"mb-6 bg-gray-800 text-white text-sm font-mono p-4 rounded-md overflow-x-auto max-h-96"},X={class:"whitespace-pre-wrap"},_={class:"space-y-8"},ee={key:0},te={key:1},se={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},oe=["value"],le={class:"lg:col-span-2"},ae=["value"],re={class:"flex items-end gap-x-4"},ne={class:"flex items-center"},ie={class:"flex items-center"},de={key:0},me={key:1},pe={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},ue=["value"],ce={class:"lg:col-span-2"},be=["value"],fe={class:"flex items-end"},ye={class:"flex items-center"},ge={key:0},xe={key:1},ke={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},ve=["value"],we=["value"],he={class:"flex items-end"},De={class:"flex items-center"},Ce={key:0},Ve={key:1},$e={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Ue={class:"flex items-end"},Ae={class:"flex items-center"},Je={__name:"JobDispatcher",props:{modelDetails:Object,newsReportModels:Array,newsConfigSets:Array},setup(c){const g=c,a=C({command:"app:dispatch-statistical-analysis-jobs",parameters:{model:"",columns:[],fresh:!1,plots:!1,resolutions:"9,8,7,6,5",trendWeeks:"4,26,52",anomalyWeeks:4}}),m=C({command:"app:dispatch-yearly-count-comparison-jobs",parameters:{model:"",columns:[],baselineYear:2019,fresh:!1}}),p=C({command:"app:dispatch-news-article-generation-jobs",parameters:{model:"all",fresh:!1,runConfig:"",reportClass:"",reportId:""}}),f=C({command:"reports:send",parameters:{userId:"",locationId:"",force:!1}}),j=J(()=>{var d;return a.parameters.model?((d=g.modelDetails[a.parameters.model])==null?void 0:d.columns)||[]:[]}),S=J(()=>{var d;return m.parameters.model?((d=g.modelDetails[m.parameters.model])==null?void 0:d.columns)||[]:[]}),D=d=>{const e={};for(const[s,i]of Object.entries(d.parameters))if(i!==""&&i!==!1&&!Array.isArray(i)||Array.isArray(i)&&i.length>0){const U=s.replace(/[A-Z]/g,F=>`-${F.toLowerCase()}`);typeof i=="boolean"?e[`--${U}`]=!0:s==="model"&&d.command!=="app:dispatch-news-article-generation-jobs"?e.model=i:Array.isArray(i)?e[`--${U}`]=i.join(","):e[`--${U}`]=i}d.transform(()=>({command:d.command,parameters:e})).post(route("admin.job-dispatcher.dispatch"),{preserveScroll:!0})},I=()=>D(a),M=()=>D(m),R=()=>D(p),W=()=>D(f);return(d,e)=>(l(),N(T,null,{default:b(()=>[w(o(Y),{title:"Job Dispatcher"}),t("div",P,[e[43]||(e[43]=t("h1",{class:"text-2xl font-semibold text-gray-800 mb-6"},"Job Dispatcher",-1)),d.$page.props.flash.success?(l(),r("div",q,u(d.$page.props.flash.success),1)):$("",!0),d.$page.props.flash.error?(l(),r("div",z,u(d.$page.props.flash.error),1)):$("",!0),d.$page.props.flash.command_output?(l(),r("div",Q,[e[19]||(e[19]=t("h3",{class:"text-lg font-semibold text-gray-300 mb-2"},"Last Command Output:",-1)),t("pre",X,u(d.$page.props.flash.command_output),1)])):$("",!0),t("div",_,[w(V,{command:"app:dispatch-statistical-analysis-jobs",title:"Statistical Analysis Jobs",description:"Dispatch jobs for H3-based trend and anomaly analysis.",onDispatch:I},{"button-text":b(()=>[o(a).processing?(l(),r("span",ee,"Dispatching...")):(l(),r("span",te,"Dispatch Job"))]),default:b(()=>[t("div",se,[t("div",null,[e[21]||(e[21]=t("label",{for:"stat-model",class:"block text-sm font-medium text-gray-700"},"Model",-1)),n(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>o(a).parameters.model=s),id:"stat-model",class:"mt-1 block w-full input"},[e[20]||(e[20]=t("option",{value:""},"All Models",-1)),(l(!0),r(v,null,k(c.modelDetails,(s,i)=>(l(),r("option",{key:i,value:i},u(i),9,oe))),128))],512),[[x,o(a).parameters.model]])]),t("div",le,[e[22]||(e[22]=t("label",{for:"stat-columns",class:"block text-sm font-medium text-gray-700"},"Columns (leave blank for all)",-1)),n(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>o(a).parameters.columns=s),id:"stat-columns",multiple:"",class:"mt-1 block w-full input h-24"},[(l(!0),r(v,null,k(j.value,s=>(l(),r("option",{key:s,value:s},u(s),9,ae))),128))],512),[[x,o(a).parameters.columns]])]),t("div",null,[e[23]||(e[23]=t("label",{for:"stat-resolutions",class:"block text-sm font-medium text-gray-700"},"Resolutions",-1)),n(t("input",{type:"text","onUpdate:modelValue":e[2]||(e[2]=s=>o(a).parameters.resolutions=s),id:"stat-resolutions",class:"mt-1 block w-full input",placeholder:"9,8,7,6,5"},null,512),[[y,o(a).parameters.resolutions]])]),t("div",null,[e[24]||(e[24]=t("label",{for:"stat-trend-weeks",class:"block text-sm font-medium text-gray-700"},"Trend Weeks",-1)),n(t("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=s=>o(a).parameters.trendWeeks=s),id:"stat-trend-weeks",class:"mt-1 block w-full input",placeholder:"4,26,52"},null,512),[[y,o(a).parameters.trendWeeks]])]),t("div",null,[e[25]||(e[25]=t("label",{for:"stat-anomaly-weeks",class:"block text-sm font-medium text-gray-700"},"Anomaly Weeks",-1)),n(t("input",{type:"number","onUpdate:modelValue":e[4]||(e[4]=s=>o(a).parameters.anomalyWeeks=s),id:"stat-anomaly-weeks",class:"mt-1 block w-full input",placeholder:"4"},null,512),[[y,o(a).parameters.anomalyWeeks]])]),t("div",re,[t("label",ne,[n(t("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=s=>o(a).parameters.fresh=s),class:"checkbox"},null,512),[[h,o(a).parameters.fresh]]),e[26]||(e[26]=t("span",{class:"ml-2 text-sm"},"--fresh",-1))]),t("label",ie,[n(t("input",{type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=s=>o(a).parameters.plots=s),class:"checkbox"},null,512),[[h,o(a).parameters.plots]]),e[27]||(e[27]=t("span",{class:"ml-2 text-sm"},"--plots",-1))])])])]),_:1}),w(V,{command:"app:dispatch-yearly-count-comparison-jobs",title:"Yearly Count Comparison Jobs",description:"Dispatch jobs for yearly data comparisons.",onDispatch:M},{"button-text":b(()=>[o(m).processing?(l(),r("span",de,"Dispatching...")):(l(),r("span",me,"Dispatch Job"))]),default:b(()=>[t("div",pe,[t("div",null,[e[29]||(e[29]=t("label",{for:"yearly-model",class:"block text-sm font-medium text-gray-700"},"Model",-1)),n(t("select",{"onUpdate:modelValue":e[7]||(e[7]=s=>o(m).parameters.model=s),id:"yearly-model",class:"mt-1 block w-full input"},[e[28]||(e[28]=t("option",{value:""},"All Models",-1)),(l(!0),r(v,null,k(c.modelDetails,(s,i)=>(l(),r("option",{key:i,value:i},u(i),9,ue))),128))],512),[[x,o(m).parameters.model]])]),t("div",ce,[e[30]||(e[30]=t("label",{for:"yearly-columns",class:"block text-sm font-medium text-gray-700"},"Columns (leave blank for all)",-1)),n(t("select",{"onUpdate:modelValue":e[8]||(e[8]=s=>o(m).parameters.columns=s),id:"yearly-columns",multiple:"",class:"mt-1 block w-full input h-24"},[(l(!0),r(v,null,k(S.value,s=>(l(),r("option",{key:s,value:s},u(s),9,be))),128))],512),[[x,o(m).parameters.columns]])]),t("div",null,[e[31]||(e[31]=t("label",{for:"yearly-baseline",class:"block text-sm font-medium text-gray-700"},"Baseline Year",-1)),n(t("input",{type:"number","onUpdate:modelValue":e[9]||(e[9]=s=>o(m).parameters.baselineYear=s),id:"yearly-baseline",class:"mt-1 block w-full input",placeholder:"2019"},null,512),[[y,o(m).parameters.baselineYear]])]),t("div",fe,[t("label",ye,[n(t("input",{type:"checkbox","onUpdate:modelValue":e[10]||(e[10]=s=>o(m).parameters.fresh=s),class:"checkbox"},null,512),[[h,o(m).parameters.fresh]]),e[32]||(e[32]=t("span",{class:"ml-2 text-sm"},"--fresh",-1))])])])]),_:1}),w(V,{command:"app:dispatch-news-article-generation-jobs",title:"News Article Generation Jobs",description:"Dispatch jobs to generate news articles from reports.",onDispatch:R},{"button-text":b(()=>[o(p).processing?(l(),r("span",ge,"Dispatching...")):(l(),r("span",xe,"Dispatch Job"))]),default:b(()=>[t("div",ke,[t("div",null,[e[34]||(e[34]=t("label",{for:"news-model",class:"block text-sm font-medium text-gray-700"},"Report Model",-1)),n(t("select",{"onUpdate:modelValue":e[11]||(e[11]=s=>o(p).parameters.model=s),id:"news-model",class:"mt-1 block w-full input"},[e[33]||(e[33]=t("option",{value:"all"},"All Report Types",-1)),(l(!0),r(v,null,k(c.newsReportModels,s=>(l(),r("option",{key:s,value:s},u(s),9,ve))),128))],512),[[x,o(p).parameters.model]])]),t("div",null,[e[36]||(e[36]=t("label",{for:"news-config",class:"block text-sm font-medium text-gray-700"},"Run Config Set",-1)),n(t("select",{"onUpdate:modelValue":e[12]||(e[12]=s=>o(p).parameters.runConfig=s),id:"news-config",class:"mt-1 block w-full input"},[e[35]||(e[35]=t("option",{value:""},"None",-1)),(l(!0),r(v,null,k(c.newsConfigSets,s=>(l(),r("option",{key:s,value:s},u(s),9,we))),128))],512),[[x,o(p).parameters.runConfig]])]),t("div",null,[e[37]||(e[37]=t("label",{for:"news-report-class",class:"block text-sm font-medium text-gray-700"},"Specific Report Class",-1)),n(t("input",{type:"text","onUpdate:modelValue":e[13]||(e[13]=s=>o(p).parameters.reportClass=s),id:"news-report-class",class:"mt-1 block w-full input",placeholder:"App\\Models\\Trend"},null,512),[[y,o(p).parameters.reportClass]])]),t("div",null,[e[38]||(e[38]=t("label",{for:"news-report-id",class:"block text-sm font-medium text-gray-700"},"Specific Report ID",-1)),n(t("input",{type:"number","onUpdate:modelValue":e[14]||(e[14]=s=>o(p).parameters.reportId=s),id:"news-report-id",class:"mt-1 block w-full input",placeholder:"123"},null,512),[[y,o(p).parameters.reportId]])]),t("div",he,[t("label",De,[n(t("input",{type:"checkbox","onUpdate:modelValue":e[15]||(e[15]=s=>o(p).parameters.fresh=s),class:"checkbox"},null,512),[[h,o(p).parameters.fresh]]),e[39]||(e[39]=t("span",{class:"ml-2 text-sm"},"--fresh",-1))])])])]),_:1}),w(V,{command:"reports:send",title:"Location Reports",description:"Dispatch jobs to send reports for user-saved locations.",onDispatch:W},{"button-text":b(()=>[o(f).processing?(l(),r("span",Ce,"Dispatching...")):(l(),r("span",Ve,"Dispatch Job"))]),default:b(()=>[t("div",$e,[t("div",null,[e[40]||(e[40]=t("label",{for:"loc-user-id",class:"block text-sm font-medium text-gray-700"},"User ID (optional)",-1)),n(t("input",{type:"number","onUpdate:modelValue":e[16]||(e[16]=s=>o(f).parameters.userId=s),id:"loc-user-id",class:"mt-1 block w-full input",placeholder:"e.g., 1"},null,512),[[y,o(f).parameters.userId]])]),t("div",null,[e[41]||(e[41]=t("label",{for:"loc-location-id",class:"block text-sm font-medium text-gray-700"},"Location ID (optional)",-1)),n(t("input",{type:"number","onUpdate:modelValue":e[17]||(e[17]=s=>o(f).parameters.locationId=s),id:"loc-location-id",class:"mt-1 block w-full input",placeholder:"e.g., 42"},null,512),[[y,o(f).parameters.locationId]])]),t("div",Ue,[t("label",Ae,[n(t("input",{type:"checkbox","onUpdate:modelValue":e[18]||(e[18]=s=>o(f).parameters.force=s),class:"checkbox"},null,512),[[h,o(f).parameters.force]]),e[42]||(e[42]=t("span",{class:"ml-2 text-sm"},"--force (ignore schedule)",-1))])])])]),_:1})])])]),_:1}))}},Re=B(Je,[["__scopeId","data-v-66417163"]]);export{Re as default};
